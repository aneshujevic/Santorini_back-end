(this.webpackJsonpsantorini=this.webpackJsonpsantorini||[]).push([[0],{19:function(e,t,s){e.exports=s(44)},43:function(e,t,s){},44:function(e,t,s){"use strict";s.r(t);var a=s(2),r=s(3),n=s(5),i=s(4),l=s(6),o=s(0),c=s.n(o),u=s(7),h=s.n(u),d=s(17),m=s.n(d);var v=function(e){return!0===e.glowing?c.a.createElement("button",{className:"square glowing",onClick:e.onClick},c.a.createElement("img",{src:e.src,alt:"Polje",width:"100%",height:"100%"})):c.a.createElement("button",{className:"square",onClick:e.onClick},c.a.createElement("img",{src:e.src,alt:"Polje",width:"100%",height:"100%"}))},p=function(e){function t(){return Object(a.a)(this,t),Object(n.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"connectButtonInput",value:function(){document.getElementById("upload-file").click()}},{key:"render",value:function(){var e=this;return"left"===this.props.side?c.a.createElement("div",{className:this.props.class},c.a.createElement("a",{href:"http://127.0.0.1:8000/home"},c.a.createElement("img",{id:"back-img",width:"100em",height:"100em",src:"/static/images/back-button.png",alt:"back-button"})),c.a.createElement("div",{className:"text-div"},c.a.createElement("ol",null,c.a.createElement("em",null,c.a.createElement("h3",null,"Instructions")),c.a.createElement("li",null,c.a.createElement("b",null,"Click")," on the two of available fields to set builder"),c.a.createElement("li",null,c.a.createElement("b",null,"Click")," on one builder to select, move and build with him on one of the highlighted fields"),c.a.createElement("li",null,c.a.createElement("em",null,c.a.createElement("b",null,"Goal")," is to get to the third floor, good luck!"))))):c.a.createElement("div",{className:this.props.class},c.a.createElement("div",{className:"text-div"},c.a.createElement("button",{onClick:function(){return e.connectButtonInput()},className:"algorithm-button"},"Import"),c.a.createElement("input",{id:"upload-file",onChange:this.props.importState,type:"file",hidden:!0}),"\xa0",c.a.createElement("button",{onClick:this.props.exportState,className:"algorithm-button"},"Export"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("span",null," ",c.a.createElement("em",null,"Moves:")," ")," ",c.a.createElement("br",null)," ",c.a.createElement("br",null),c.a.createElement("div",{id:"moves"})))}}]),t}(c.a.Component),f="http://127.0.0.1:8000/getAvailableMoves/",b=!1,g=function(e){function t(e){var s;return Object(a.a)(this,t),(s=Object(n.a)(this,Object(i.a)(t).call(this,e))).state={cells:Array(25).fill(0),firstHE:-1,secondHE:-1,firstJU:-1,secondJU:-1,availableMovesOrBuilds:[],juNext:!0},s.humanPlayer=e.human,s.chooseMove=!1,s.moving=!1,s.building=!1,s.buildersSetUp=0,s.lastClickedId=-1,s.whoseMove="Jupiter's move",s.upperBoundCellValueJU=12,s.lowerBoundCellValueJU=9,s.upperBoundCellValueHE=8,s.lowerBoundCellValueHE=4,s}return Object(l.a)(t,e),Object(r.a)(t,[{key:"clickHandle",value:function(e){var t=this;if(!b)if(this.buildersSetUp<2)this.setUpBuilders(e);else if(this.buildersSetUp<4)this.setUpBuilders(e);else{var s,a;if(this.state.juNext?(s=this.lowerBoundCellValueJU,a=this.upperBoundCellValueJU):(s=this.lowerBoundCellValueHE,a=this.upperBoundCellValueHE),s<=this.state.cells[e]&&this.state.cells[e]<=a&&(!1===this.moving&&!1===this.building&&e!==this.lastClickedId&&-1===this.lastClickedId?(this.lastClickedId=e,this.chooseMove=!0):e===this.lastClickedId&&!1===this.building&&(this.chooseMove=!1,this.moving=!1,this.lastClickedId=-1,this.setState({availableMovesOrBuilds:null}))),!0===this.chooseMove&&(this.lastClickedId===e?this.setupAvailableMoves(e,f):(this.chooseMove=!1,this.moving=!0)),!0===this.moving&&null!=this.state.availableMovesOrBuilds.find((function(t){return t===e})))return this.moveFigure(this.lastClickedId,e,(function(){return t.setupAvailableMoves(e,"http://127.0.0.1:8000/getAvailableBuilds/")})),this.lastClickedId=-1,this.moving=!1,void(this.building=!0);!0===this.building&&null!=this.state.availableMovesOrBuilds.find((function(t){return t===e}))&&(this.buildBlock(e),this.building=!1,this.setState({availableMovesOrBuilds:null},(function(){return t.changeMoveUI()})))}}},{key:"setUpBuilders",value:function(e){var t=this,s=this.state.cells;0===s[e]?(this.buildersSetUp<2?(s[e]=9,this.setState({cells:s,firstJU:0===this.buildersSetUp?e:this.state.firstJU,secondJU:1===this.buildersSetUp?e:this.state.secondJU,juNext:1===this.buildersSetUp?!this.state.juNext:this.state.juNext},(function(){return t.changeMoveUI()}))):this.buildersSetUp<4&&(s[e]=5,this.setState({cells:s,firstHE:2===this.buildersSetUp?e:this.state.firstHE,secondHE:3===this.buildersSetUp?e:this.state.secondHE,juNext:3===this.buildersSetUp?!this.state.juNext:this.state.juNext},(function(){return t.changeMoveUI()}))),this.buildersSetUp++,this.logSetupUI(e,this.buildersSetUp)):alert("Field is taken, please try again..")}},{key:"setupAvailableMoves",value:function(e,t){var s=this;this.getMovesFromServer(e,t).then((function(e){return s.setState({availableMovesOrBuilds:e})}))}},{key:"getMovesFromServer",value:function(e,t){var s,a,r;return h.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return s=this.state.cells.slice().map((function(e){return e>=9?(e+1)%5:e>=5?e%5:e})),a=[{cells:s,firstHE:this.state.firstHE,secondHE:this.state.secondHE,firstJU:this.state.firstJU,secondJU:this.state.secondJU,startPosition:[Math.floor(e/5),e%5],depth:null}],n.next=4,h.a.awrap(m.a.post(t,a).catch((function(e){console.log(e)})));case 4:return r=n.sent,n.abrupt("return",r.data.moves.map((function(e){return 5*e[0]+e[1]})));case 6:case"end":return n.stop()}}),null,this)}},{key:"moveFigure",value:function(e,t,s){var a=Math.floor((this.state.cells[e]+1)/5),r=this.state.cells.slice(),n=r[e];r[e]=n>=9?(r[e]+1)%5:r[e]%5,r[t]=n>=9?5*a+r[t]-1:5*a+r[t],this.logMoveUI(e,!1),this.logMoveUI(t,!1),this.setState({firstHE:this.state.firstHE===e?t:this.state.firstHE,secondHE:this.state.secondHE===e?t:this.state.secondHE,firstJU:this.state.firstJU===e?t:this.state.firstJU,secondJU:this.state.secondJU===e?t:this.state.secondJU,cells:r},s)}},{key:"buildBlock",value:function(e){var t=this,s=this.state.cells.slice();s[e]+=1,this.logMoveUI(e,!0),this.setState({cells:s,juNext:!this.state.juNext},(function(){return t.checkWin()}))}},{key:"checkWin",value:function(){var e=this.state.cells.findIndex((function(e){return 12===e||8===e}));if(-1!==e){switch(this.state.cells[e]){case 8:alert("Hercules won!");break;case 12:alert("Jupiter won!")}return b=!0,void(window.confirm("Do you want to play another game?")&&window.location.reload())}var t=this.state.firstJU,s=this.state.secondJU,a=this.state.firstHE,r=this.state.secondHE;0===this.getMovesFromServer(t,f).length&&0===this.getMovesFromServer(s,f).length?(b=!0,alert("Hercules won!")):0===this.getMovesFromServer(a,f).length&&0===this.getMovesFromServer(r,f).length&&(b=!0,alert("Jupiter won!")),b&&window.confirm("Do you want to play another game?")&&window.location.reload()}},{key:"downloadState",value:function(){var e=document.getElementById("moves").innerHTML;e=e.replace(/\s?<br>\s?/g,"\n"),e+="\n";var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download","game_state.txt"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}},{key:"loadState",value:function(e){var t=this;if(-1===this.state.firstJU){var s=new FileReader;s.onload=function(e){return t.loadMoves(e)},s.readAsText(e.target.files[0])}else window.confirm("You must refresh page before importing a game state.\nRefresh now?")&&window.location.reload()}},{key:"loadMoves",value:function(e){var t=e.target.result.trim().split("\n");this.setUpBuildersFromImport(t),this.doMovesFromImport(t)}},{key:"setUpBuildersFromImport",value:function(e){for(var t=0;t<2;t++){var s=e.shift().split(" "),a=this.convertCoordinatesImport(s[0]),r=this.convertCoordinatesImport(s[1]);this.setUpBuilders(a),this.setUpBuilders(r)}}},{key:"doMovesFromImport",value:function(e){for(;0!==e.length;){var t=e.shift().split(" "),s=this.convertCoordinatesImport(t[0]),a=this.convertCoordinatesImport(t[1]),r=this.convertCoordinatesImport(t[2]);this.moveFigure(s,a),this.buildBlock(r)}}},{key:"convertCoordinatesImport",value:function(e){var t=e[0],s=parseInt(e[1])-1;switch(t){case"A":t=0;break;case"B":t=1;break;case"C":t=2;break;case"D":t=3;break;case"E":t=4}return 5*t+s}},{key:"convertCoordinatesOut",value:function(e){var t=e%5,s="";switch(Math.floor(e/5)){case 0:s+="A";break;case 1:s+="B";break;case 2:s+="C";break;case 3:s+="D";break;case 4:s+="E"}return s+=String(t+1)+" "}},{key:"logMoveUI",value:function(e,t){var s=document.getElementById("moves"),a=this.convertCoordinatesOut(e);t&&(a+="<br>"),s.innerHTML+=a}},{key:"logSetupUI",value:function(e,t){var s=document.getElementById("moves"),a=this.convertCoordinatesOut(e);switch(t){case 2:case 4:a+="<br>"}s.innerHTML+=a}},{key:"changeMoveUI",value:function(){switch(this.state.juNext){case!1:this.whoseMove="Hercules's move";break;case!0:this.whoseMove="Jupiter's move"}document.getElementsByClassName("who-move")[0].textContent=this.whoseMove}},{key:"render",value:function(){var e=this,t=this.state.cells.map((function(t){return e.getImageSourceCell(t)}));return c.a.createElement("div",{className:"main-div"},c.a.createElement(p,{side:"left",class:"left-panel"}),c.a.createElement("div",{className:"board"},c.a.createElement("div",{className:"first-row"},c.a.createElement("div",{className:"column-number-cell"},"1"),c.a.createElement("div",{className:"column-number-cell"},"2"),c.a.createElement("div",{className:"column-number-cell"},"3"),c.a.createElement("div",{className:"column-number-cell"},"4"),c.a.createElement("div",{className:"column-number-cell"},"5")),c.a.createElement("div",{className:"board-row"},c.a.createElement("span",{className:"row-number-cell"},"A"),this.renderSquare(t[0],0),this.renderSquare(t[1],1),this.renderSquare(t[2],2),this.renderSquare(t[3],3),this.renderSquare(t[4],4)),c.a.createElement("div",{className:"board-row"},c.a.createElement("span",{className:"row-number-cell"},"B"),this.renderSquare(t[5],5),this.renderSquare(t[6],6),this.renderSquare(t[7],7),this.renderSquare(t[8],8),this.renderSquare(t[9],9)),c.a.createElement("div",{className:"board-row"},c.a.createElement("span",{className:"row-number-cell"},"C"),this.renderSquare(t[10],10),this.renderSquare(t[11],11),this.renderSquare(t[12],12),this.renderSquare(t[13],13),this.renderSquare(t[14],14)),c.a.createElement("div",{className:"board-row"},c.a.createElement("span",{className:"row-number-cell"},"D"),this.renderSquare(t[15],15),this.renderSquare(t[16],16),this.renderSquare(t[17],17),this.renderSquare(t[18],18),this.renderSquare(t[19],19)),c.a.createElement("div",{className:"board-row"},c.a.createElement("span",{className:"row-number-cell"},"E"),this.renderSquare(t[20],20),this.renderSquare(t[21],21),this.renderSquare(t[22],22),this.renderSquare(t[23],23),this.renderSquare(t[24],24)),c.a.createElement("span",{className:"who-move"},this.whoseMove)),c.a.createElement(p,{side:"right",class:"right-panel",importState:function(t){return e.loadState(t)},exportState:function(){return e.downloadState()}}))}},{key:"getImageSourceCell",value:function(e){switch(e){case 0:return"lvl_0.jpg";case 1:return"lvl_1.png";case 2:return"lvl_2.png";case 3:return"lvl_3.png";case 4:return"lvl_4.png";case 5:return"hercules.png";case 6:return"lvl_1_HE.png";case 7:return"lvl_2_HE.png";case 8:return"lvl_3_HE.png";case 9:return"jupiter.png";case 10:return"lvl_1_JU.png";case 11:return"lvl_2_JU.png";case 12:return"lvl_3_JU.png";default:return""}}},{key:"renderSquare",value:function(e,t){var s,a=this,r=null!=(null===(s=this.state.availableMovesOrBuilds)||void 0===s?void 0:s.find((function(e){return e===t})));return c.a.createElement(v,{src:"/static/images/".concat(e),onClick:function(){return a.clickHandle(t)},glowing:r})}}]),t}(c.a.Component),E=function(e){function t(){return Object(a.a)(this,t),Object(n.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(g,{human:"JU"})}}]),t}(c.a.Component),k=s(18),S=s.n(k);s(43);S.a.render(c.a.createElement(E,null),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.9219f912.chunk.js.map